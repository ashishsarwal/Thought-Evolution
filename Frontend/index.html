<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thought Evolution</title>
    <link rel="stylesheet" href="./css/main.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="./js/main.js"></script>
    <style>
        .carousel-caption{
            margin-left: -5rem;
        }

        .carousel-control-next, .carousel-control-prev{
            width: 5%;
        }

        .carousel-caption .display-3{
            font-size: 3.75rem;
        }
        .carousel-caption p{
            font-size: 1.25rem;
        }
        
    </style>
</head>
<body>
    <div class="bg-primary pt-5 sticky-top" style="top: -3rem;">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark justify-content-center">
                <script>createNav('HOME');</script>
            </nav>
        </div>
      </div>
      <div class="main">
        <div class="container">
            <div class="container mt-5">
                <div id="carousel-main" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-indicators">
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="1" aria-label="Slide 2"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="2" aria-label="Slide 3"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="3" aria-label="Slide 4"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="4" aria-label="Slide 5"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="5" aria-label="Slide 6"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="6" aria-label="Slide 7"></button>
                        <button type="button" data-bs-target="#carousel-main" data-bs-slide-to="7" aria-label="Slide 8"></button>
                    </div>
                    <div id="main-carousal" class="carousel-inner">
                        <script>
                            function createCarousal(){
                                fetch(getAPIDomain() + '/banner/active')
                                .then((response) => response.json())
                                .then(data =>{
                                    let carousalHTML = ``;
                                    console.log(data);                                    
                                    data.forEach((banner, index) => {  
                                        carousalHTML += `<a href='./view-blog.html?blogId=${banner.BlogId}'>`;   
                                        if(index == 0){
                                            carousalHTML += `<div class="carousel-item active">`;
                                        }   
                                        else{
                                            carousalHTML += `<div class="carousel-item">`;
                                        }                           
                                        carousalHTML += `<img src="${getImageDomain() + '/images/banner-' + banner.Id + '.png'}" alt="" width="100%">`;
                                        carousalHTML += `<div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">`
                                        carousalHTML += `<h1 class="display-3">${banner.Title}</h1>`;
                                        carousalHTML += `<p>${banner.Description}</p>`;
                                        carousalHTML += `</div>`;
                                        carousalHTML += `</div>`
                                        carousalHTML += `</a>`;
                                    });   
                                    document.getElementById('main-carousal').innerHTML = carousalHTML;                                 
                                });

                            }
                            createCarousal();
                        </script>
                        <!-- <div class="carousel-item active">
                            <img src="./resources/banners/001.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">Modernity and Spirituality</h1>
                                <p>The challenges of our time are spiritual nature, because most decisions which must be taken are not just practical, but also moral.</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/002.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">Rethinking Education in the 21st Century</h1>
                                <p>How can we redesign education to equip students with the skills needed to thrive in a rapidly evolving world?</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/003.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">Contribution of art to well-being society</h1>
                                <p>Ability to meditate - distinguishing feature human being. Moreover, human development it would be impossible without reflections and contemplation.</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/004.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">Can religion offer insights about technological development?</h1>
                                <p>For technology to become a means progress, it must strengthen noble aspirations and principles such as unity and justice.</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/005.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">How to expand borders of traditional scientific discourses?</h1>
                                <p>Young People's Conference scientists in St. Petersburg called create a base for new humanitarian perspectives knowledge.</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/006.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">The role of women in promoting peace</h1>
                                <p>Women's ability to nurture cooperation and expand the circle participants is extremely important for efforts aimed at building a prosperous society.</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/007.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-4 mb-4 text-start">
                                <h1 class="display-3">Science and Religion</h1>
                                <p>How this two systems can work together for progress?</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="./resources/banners/008.jpg" alt="" width="100%">
                            <div class="carousel-caption d-none d-md-block col-5 mb-4 text-start">
                                <h1 class="display-3">Rethinking relationship with nature</h1>
                                <p>What needs to be done to our intentions did not disagree with the actions?</p>
                            </div>
                        </div> -->
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carousel-main" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carousel-main" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
            <div class="contaiener mt-5 mx-2 px-5">
                <img src="./resources/icons.png" alt="" width="100%">
                <div id="image-text" class="row pt-3">
                    <script>
                        async function createTopicMenu(){
                        const response = await fetch(getAPIDomain() + '/topic/top-5');
                        const data = await response.json();
                        let listHtml = '';
                        data.forEach(item =>{
                                listHtml = listHtml + `<div class="col text-center">`;
                                listHtml = listHtml + `<h5>${item.Name}</h5>`;
                                listHtml = listHtml + `</div>`;
                            });
                            document.getElementById('image-text').innerHTML = listHtml;

                        };
                        createTopicMenu();
                    </script>
                </div>
                <div id="clickable-cnt" class="row clickable">
                    <script>
                        async function createClickableImage(){
                        const response = await fetch(getAPIDomain() + '/topic/top-5');
                        const data = await response.json();
                        let listHtml = '';
                        data.forEach(item =>{
                                listHtml = listHtml + `<a href="#topic-${item.Id}" class="col">${item.Name}</a>`;
                            });
                            document.getElementById('clickable-cnt').innerHTML = listHtml;

                        };
                        createClickableImage();
                    </script>
                </div>
            </div>
            <div id="BlogsByTopic" class="container mt-5"></div>
            <footer class="mt-5 bg-primary p-l">
                <div>
                    <h4> > today's thought create tomorrow's life </h4>
                    <div>&#xa9; thoughtevolution.ru / эволюциямысли.рф</div>
                </div>
            </footer>
        </div>
    </div>
    <script>
        let topics;
        let blogs;
        //Function that returns topics
        function createBlogsTopicWiseUI(){
            //Fetch Topics
            fetch(getAPIDomain() + '/topic/active')
            .then((response) => response.json())
            .then(data =>{
                topics = data;
                //Counter for number of blogs in one line.
                topics.forEach(topic => {
                document.getElementById('BlogsByTopic').innerHTML = document.getElementById('BlogsByTopic').innerHTML  
                                                                  + `<div id="topic-${topic.Id}" class="pt-l"><div><div><h3>${topic.Name}</h3></div><div style="width: 75%;">`
                                                                  + `<img src="${getImageDomain() + '/images/topic-' + topic.Id + '.png'}" style="width:100%; margin-top: -132px;" class="mb-5">`
                                                                  + `<h5 style="text-align: justify;"><i>&nbsp;&nbsp;${topic.Description.replaceAll('<br>','<br><br>&nbsp;&nbsp;')}</i><h5></div></div>`;
                    //Fetch Blogs
                    fetch(getAPIDomain() + `/blogs_by_topic/top/${topic.Id}`)
                    .then((response) => response.json())
                    .then((data) => {
                        //Create HTML
                        let blogsByTopic = `<div class="row"><div id="topic-${topic.Id}-container" class="col-9">`;
                        //initialize counter for each topic
                        let counter = 0;
                        data.forEach(blog =>{
                            //Check if counter is zero and start creating a new row
                            if(counter == 0){
                                blogsByTopic = blogsByTopic + '<div class="row mt-5">';//row starts here
                            }
                            blogsByTopic = blogsByTopic + `<a class="col-4" href="./view-blog.html?blogId=${blog.Id}"><div>`;//column starts here
                            // if(blog.BlogImage = ''){
                                blogsByTopic = blogsByTopic + `<img src="${getImageDomain() + '/images/blog-' + blog.Id + '.png'}" alt=" loading..." height="200" style="max-width: 100%;" class="mb-3">`;
                            // }
                            // else{
                            //     blogsByTopic = blogsByTopic + `<div style="height: 200px"></div>`;
                            // }
                            blogsByTopic = blogsByTopic + `<div><h4>${blog.Title}</h4></div>`;
                            blogsByTopic = blogsByTopic + `<div><h6><i>${blog.Description}</i></h6></div>`;
                            blogsByTopic = blogsByTopic + `</div></a>`; // column ends here
                            counter = counter + 1;
                            //Check if four columns are added start new row
                            if(counter == 3){
                                blogsByTopic = blogsByTopic + '</div>'; // row ends here
                                counter = 0;
                            }
                        });
                        blogsByTopic = blogsByTopic + `<div class="col-4"><div style="height: 200px;" class="more" onclick="getAllBlogsForTopicById(${topic.Id})"><div><div><i>See more blogs</i></div></div></div></div>`;
                        if(counter < 3 && counter > 0){
                            blogsByTopic = blogsByTopic + '</div>'; // end last row
                        }
                        if(`${topic.Quote}` != 'null'){
                            blogsByTopic = blogsByTopic + `</div><div class="col-3 mt-5 side-quote"><h5><i> ${topic.Quote} </i></h5></div></div></div>`
                        }
                        else{
                            blogsByTopic = blogsByTopic + `</div><div class="col-3 pt-5"><h5><i></i></h5></div></div></div>`

                        }
                        document.getElementById(`topic-${topic.Id}`).innerHTML = document.getElementById(`topic-${topic.Id}`).innerHTML + blogsByTopic;
                    });                    
                });
            });
        };
        //Function that returns blogs
        function getBlogsList(){
            fetch(getAPIDomain() + '/blogs_by_topic')
            .then((response) => response.json())
            .then((data) => {
                blogs = data;
            });
        }
        //Function Call
        createBlogsTopicWiseUI();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>